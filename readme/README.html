<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>buchstabensuppe/README</title>
    <link rel="stylesheet" type="text/css" href="../style.css">
  </head>

<body><main>
<h1 id="buchstabensuppe">buchstabensuppe</h1>

<pre><code> █             
 █             
 █             
 █ ███    ████ 
 ██   █  █    █
 █    █  █     
 █    █   ██   
 █    █     ██ 
 █    █       █
 ██   █  █    █
 █ ███    ████ 
</code></pre>

<blockquote>
<p>at least better than PIL.ImageFont</p>
</blockquote>

<p>toy font rendering for low pixelcount high contrast displays,
i. e. <a href="https://wiki.openlab-augsburg.de/Flipdots">openlab&#39;s flipdot display</a>.</p>

<h2 id="features">features</h2>

<ul>
<li>supports <a href="https://harfbuzz.github.io/what-is-harfbuzz.html#what-is-text-shaping">text shaping</a>
via harfbuzz</li>
<li>per grapheme cluster font fallback</li>
<li>grayscale and binary b&#47;w support</li>
</ul>

<h2 id="building">building</h2>

<p>requirements:</p>

<ul>
<li><a href="https://github.com/leahneukirchen/redo-c">redo-c</a></li>
<li>Optionally <code>make</code> for install script and such</li>
<li><a href="https://juliastrings.github.io/utf8proc">utf8proc</a></li>
<li><a href="harfbuzz.github.io/">harfbuzz</a></li>
</ul>

<pre><code># run inside nix-shell if you have nix!

# static library
$ redo libbuchstabensuppe.a

# demo binary
$ redo bs-renderflipdot.exe

# tests
$ redo test.exe &#38;&#38; .&#47;test.exe
</code></pre>

<p>alternatively you can just run <code>nix-build</code></p>

<h2 id="demo">demo</h2>

<p>if you want to play around with the font rendering in binary
mode you can use the dry run mode of the supplied <code>.&#47;bs-renderflipdot.exe</code>
(or <code>.&#47;result&#47;bin&#47;bs-renderflipdot</code> if you use nix) binary.</p>

<p>Run <code>.&#47;bs-renderflipdot.exe -?</code> for usage instructions and don&#39;t forget <code>-n</code>
for dry running!</p>

<pre><code>$ .&#47;bs-renderflipdot.exe -f fonts&#47;unifont.ttf -f fonts&#47;unifont_upper.ttf -n "Greetings ❣️" 2&#62;&#47;dev&#47;null
                                                                                            
                                                                                    ███ ███ 
                                                                                   █████████
                                            █                                      █████████
  ████                             █        █                                      █████████
 █    █                            █                          █                     ███████ 
 █    █  █ ███    ████    ████     █       ██    █ ███    ███ █   ████                ███   
 █       ██   █  █    █  █    █  █████      █    ██   █  █   █   █    █                █    
 █       █    █  █    █  █    █    █        █    █    █  █   █   █                          
 █  ███  █       ██████  ██████    █        █    █    █  █   █    ██                  ███   
 █    █  █       █       █         █        █    █    █   ███       ██               █████  
 █    █  █       █       █         █        █    █    █   █           █              █████  
 █   ██  █       █    █  █    █    █        █    █    █   ████   █    █              █████  
  ███ █  █        ████    ████      ██    █████  █    █  █    █   ████                ███   
                                                         █    █                             
                                                          ████                              
</code></pre>

<h2 id="flipdot%20interaction">flipdot interaction</h2>

<p><img src="doc/flipdot-render.png" alt="An example where buchstabensuppe does an admirable job rendering a string onto a simulated flipdot display" /></p>

<p>the picture above shows buchstabensuppe being used to render text
onto a simulated flipdot display. take notice especially of the following:</p>

<ul>
<li>fallback fonts are supported: the emoji is not found in <code>unifont.ttf</code>,
but rendered from <code>unifont_upper.ttf</code></li>
<li>correct text shaping is supported (as far as the font supports it):
g̈ which consists of two codepoints is rendered as a combined cluster
consisting of two glyphs.</li>
</ul>

<p><a href="./bs-renderflipdot.c">bs-renderflipdot.c</a> is a simple example showing
how to interact with a flipdot display. mainly it involves:</p>

<ul>
<li>rendering a string to a bitmap using <code>bs_render_utf8_string</code></li>
<li>making sure that the dimensions of the display and the image
match with <code>bs_bitmap_extend</code></li>
<li>processing the resulting bitmap using <code>bs_bitmap_map</code></li>
<li>producing a compacted bitmap array for the display
using <code>bs_view_bitarray</code> ready to sent via UDP</li>
</ul>

<p>you can also play around with its cli: the following command
renders “Hello World” black on white using GNU Unifont onto
a flipdot display (or simulator) running on <code>localhost:2323</code>.
See <a href="https://sternenseemann.github.io/buchstabensuppe/man/bs-renderflipdot.1.html">bs-renderflipdot(1)</a>
for more usage details.</p>

<pre><code>.&#47;bs-renderflipdot.exe -f &#47;path&#47;to&#47;unifont.ttf -f &#47;path&#47;to&#47;unifont_upper.ttf -i "Hello World"
</code></pre>

<h2 id="caveats">caveats</h2>

<ul>
<li>buchstabensuppe loads all fonts into memory and keeps them there pretty much
all the time.</li>
<li>buchstabensuppe uses <code>stb_truetype</code> which does
<a href="https://github.com/nothings/stb/blob/b42009b3b9d4ca35bc703f5310eedc74f584be58/stb_truetype.h#L4-L11">no boundary checking on fonts</a>,
so it is highly inadvisable to use buchstabensuppe with untrusted fonts.</li>
</ul>
</main></body></html>
